<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Get started with purrr • purrr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_Pro-0.4.10/font.css" rel="stylesheet">
<link href="../deps/Source_Code_Pro-0.4.10/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Get started with purrr">
<meta name="robots" content="noindex">
<script src="https://cdn.jsdelivr.net/gh/posit-dev/supported-by-posit/js/badge.min.js" data-max-height="43" data-light-bg="#666f76" data-light-fg="#f9f9f9"></script><script defer data-domain="purrr.tidyverse.org,all.tidyverse.org" src="https://plausible.io/js/plausible.js"></script>
</head>
<body>
    <a href="#container" class="visually-hidden-focusable">Skip to content</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-none" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">purrr</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">1.1.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/purrr.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/base.html">purrr &lt;-&gt; base R</a></li>
    <li><a class="dropdown-item" href="../articles/other-langs.html">Functional programming in other languages</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-news" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">News</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-news">
<li><h6 class="dropdown-header" data-toc-skip>Releases</h6></li>
    <li><a class="external-link dropdown-item" href="https://www.tidyverse.org/blog/2025/07/purrr-1-1-0-parallel/">Version 1.1.0</a></li>
    <li><a class="external-link dropdown-item" href="https://www.tidyverse.org/blog/2022/12/purrr-1-0-0/">Version 1.0.0</a></li>
    <li><a class="external-link dropdown-item" href="https://www.tidyverse.org/articles/2019/02/purrr-0-3-0/">Version 0.3.0</a></li>
    <li><a class="external-link dropdown-item" href="https://www.tidyverse.org/articles/2017/08/purrr-0.2.3/">Version 0.2.3</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../news/index.html">Changelog</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/tidyverse/purrr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article" id="container">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Get started with purrr</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/tidyverse/purrr/blob/main/vignettes/purrr.Rmd" class="external-link"><code>vignettes/purrr.Rmd</code></a></small>
      <div class="d-none name"><code>purrr.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>purrr helps you write cleaner, more maintainable R code through
functional programming concepts. But what is functional programming? At
its core, it’s an approach to programming that emphasizes using
functions to transform data, similar to how you might use a series of
tools to process raw materials into a final product. Instead of writing
loops and modifying data step by step, functional programming encourages
you to think about your data transformations as a series of function
applications. This notion is rather abstract, but we believe mastering
functional programming makes your code clearer and less prone to errors.
You’ll hopefully get some sense of that by the end of this vignette!</p>
<p>This vignette discusses two of the most important parts of purrr: map
functions and predicate functions.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://purrr.tidyverse.org/">purrr</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="map-a-better-way-to-loop">Map: A better way to loop<a class="anchor" aria-label="anchor" href="#map-a-better-way-to-loop"></a>
</h2>
<p><code><a href="../reference/map.html">map()</a></code><a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;You might wonder why this function is called
&lt;code&gt;&lt;a href="../reference/map.html"&gt;map()&lt;/a&gt;&lt;/code&gt;. What does it have to do with depicting physical
features of land or sea 🗺? In fact, the meaning comes from mathematics
where map refers to “an operation that associates each element of a
given set with one or more elements of a second set”. This makes sense
here because &lt;code&gt;&lt;a href="../reference/map.html"&gt;map()&lt;/a&gt;&lt;/code&gt; defines a mapping from one vector to
another. And “map” also has the nice property of being short, which is
useful for such a fundamental building block.&lt;/p&gt;'><sup>1</sup></a> provides a more compact way to apply
functions to each element of a vector, returning a list:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span></span>
<span></span>
<span><span class="va">triple</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span> <span class="op">*</span> <span class="fl">3</span></span>
<span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/map.html">map</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">triple</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 3</span></span>
<span><span class="co">#&gt;  $ : num 3</span></span>
<span><span class="co">#&gt;  $ : num 6</span></span>
<span><span class="co">#&gt;  $ : num 9</span></span></code></pre></div>
<p>Or written with the pipe:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/map.html">map</a></span><span class="op">(</span><span class="va">triple</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 3</span></span>
<span><span class="co">#&gt;  $ : num 3</span></span>
<span><span class="co">#&gt;  $ : num 6</span></span>
<span><span class="co">#&gt;  $ : num 9</span></span></code></pre></div>
<p>This is equivalent to a for loop:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></span><span class="op">(</span><span class="st">"list"</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">out</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">triple</span><span class="op">(</span><span class="va">x</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 3</span></span>
<span><span class="co">#&gt;  $ : num 3</span></span>
<span><span class="co">#&gt;  $ : num 6</span></span>
<span><span class="co">#&gt;  $ : num 9</span></span></code></pre></div>
<p>Even on its own, there are some benefits to <code><a href="../reference/map.html">map()</a></code>: once
you get used to the syntax, it’s a very compact way to express the idea
of transforming a vector, returning one output element for each input
element. But there are several other reasons to use <code><a href="../reference/map.html">map()</a></code>,
which we’ll explore in the following sections:</p>
<ul>
<li>Progress bars</li>
<li>Parallel computing</li>
<li>Output variants</li>
<li>Input variants</li>
</ul>
<div class="section level3">
<h3 id="progress-bars">Progress bars<a class="anchor" aria-label="anchor" href="#progress-bars"></a>
</h3>
<p>For long-running jobs, like web scraping, model fitting, or data
processing, it’s really useful to get a progress bar that helps you
estimate how long you’ll need to wait. Progress bars are easy to enable
in purrr: just set <code>.progress = TRUE</code>. It’s hard to
illustrate progress bars in a vignette, but you can try this example
interactively:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/map.html">map</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span>, \<span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.sleep.html" class="external-link">Sys.sleep</a></span><span class="op">(</span><span class="fl">0.5</span><span class="op">)</span>, .progress <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>Learn more about progress bars in <code><a href="../reference/progress_bars.html">?progress_bars</a></code>.</p>
</div>
<div class="section level3">
<h3 id="parallel-computing">Parallel computing<a class="anchor" aria-label="anchor" href="#parallel-computing"></a>
</h3>
<p>By default, <code><a href="../reference/map.html">map()</a></code> runs only in your current R session.
But you can easily opt in to spreading your task across multiple R
sessions, and hence multiple cores with <code><a href="../reference/in_parallel.html">in_parallel()</a></code>. This
can give big performance improvements if your task is primarily bound by
compute performance.</p>
<p>purrr’s parallelism is powered by mirai, so to begin, you need to
start up a number of background R sessions, called
<strong>daemons</strong>:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">mirai</span><span class="fu">::</span><span class="fu"><a href="https://mirai.r-lib.org/reference/daemons.html" class="external-link">daemons</a></span><span class="op">(</span><span class="fl">6</span><span class="op">)</span></span></code></pre></div>
<p>(You only need to do this once per session.)</p>
<p>Now you can easily convert your <code><a href="../reference/map.html">map()</a></code> call to run in
parallel:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/map.html">map</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fu"><a href="../reference/in_parallel.html">in_parallel</a></span><span class="op">(</span>\<span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.sleep.html" class="external-link">Sys.sleep</a></span><span class="op">(</span><span class="fl">0.5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>It’s important to realize that this parallelism works by spreading
computation across clean R sessions. That means that code like this will
not work, because the worker daemons won’t have a copy of
<code>my_lm()</code>:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_lm</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">formula</span>, <span class="va">data</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Sys.sleep.html" class="external-link">Sys.sleep</a></span><span class="op">(</span><span class="fl">0.5</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">formula</span>, <span class="va">data</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">by_cyl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span><span class="va">mtcars</span>, <span class="va">mtcars</span><span class="op">$</span><span class="va">cyl</span><span class="op">)</span></span>
<span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/map.html">map</a></span><span class="op">(</span><span class="va">by_cyl</span>, <span class="fu"><a href="../reference/in_parallel.html">in_parallel</a></span><span class="op">(</span>\<span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="fu">my_lm</span><span class="op">(</span><span class="va">mpg</span> <span class="op">~</span> <span class="va">disp</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00; font-weight: bold;">Error</span><span style="font-weight: bold;"> in `map()`:</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> In index: 1.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> With name: 4.</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Caused by error in `my_lm()`:</span></span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> could not find function "my_lm"</span></span></code></pre></div>
<p>You can resolve this by passing additional data along to
<code><a href="../reference/in_parallel.html">in_parallel()</a></code>:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/map.html">map</a></span><span class="op">(</span><span class="va">by_cyl</span>, <span class="fu"><a href="../reference/in_parallel.html">in_parallel</a></span><span class="op">(</span>\<span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="fu">my_lm</span><span class="op">(</span><span class="va">mpg</span> <span class="op">~</span> <span class="va">disp</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span>, my_lm <span class="op">=</span> <span class="va">my_lm</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Learn more about parallel computing in <code><a href="../reference/in_parallel.html">?in_parallel</a></code>.</p>
</div>
<div class="section level3">
<h3 id="output-variants">Output variants<a class="anchor" aria-label="anchor" href="#output-variants"></a>
</h3>
<p>purrr functions are type-stable, which means it’s easy to predict
what type of output they return, e.g., <code><a href="../reference/map.html">map()</a></code> always returns
a list. But what if you want a different type of output? That’s where
the output variants come into play:</p>
<ul>
<li>
<p>There are four variants for the four most important types of
atomic vector:</p>
<ul>
<li>
<code><a href="../reference/map.html">map_lgl()</a></code> returns a logical vector.</li>
<li>
<code><a href="../reference/map.html">map_int()</a></code> returns an integer vector.</li>
<li>
<code><a href="../reference/map.html">map_dbl()</a></code> returns a numeric (double) vector.</li>
<li>
<code><a href="../reference/map.html">map_chr()</a></code> returns a character vector.</li>
</ul>
</li>
<li><p>For all other types of vector (like dates, date-times, factors,
etc.), there’s <code><a href="../reference/map.html">map_vec()</a></code>. It’s a little harder to precisely
describe the output type, but if your function returns a length-1 vector
of type “foo”, then the output of <code><a href="../reference/map.html">map_vec()</a></code> will be a
length-n vector of type “foo”.</p></li>
<li><p><code><a href="../reference/modify.html">modify()</a></code> returns output with the same type as the
input. For example, if the input is a data frame, the output will also
be a data frame.</p></li>
<li><p><code><a href="../reference/map.html">walk()</a></code> returns the input (invisibly); it’s useful
when you’re calling a function purely for its side effects, for example,
generating plots or saving files.</p></li>
</ul>
<p>purrr, like many tidyverse functions, is designed to help you solve
complex problems by stringing together simple pieces. This is
particularly natural to do with the pipe. For example, the following
code splits <code>mtcars</code> into one data frame for each value of
<code>cyl</code>, fits a linear model to each subset, computes the model
summary, and then extracts the R-squared:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mtcars</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">$</span><span class="va">cyl</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="co"># from base R</span></span>
<span>  <span class="fu"><a href="../reference/map.html">map</a></span><span class="op">(</span>\<span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">mpg</span> <span class="op">~</span> <span class="va">wt</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/map.html">map</a></span><span class="op">(</span><span class="va">summary</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/map.html">map_dbl</a></span><span class="op">(</span>\<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">$</span><span class="va">r.squared</span><span class="op">)</span></span>
<span><span class="co">#&gt;         4         6         8 </span></span>
<span><span class="co">#&gt; 0.5086326 0.4645102 0.4229655</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="input-variants">Input variants<a class="anchor" aria-label="anchor" href="#input-variants"></a>
</h3>
<p><code><a href="../reference/map.html">map()</a></code> and friends all iterate over a single list, making
it poorly suited for some problems. For example, how would you find a
weighted mean when you have a list of observations and a list of
weights? Imagine we have the following data:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">xs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/map.html">map</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">8</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">xs</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span><span class="va">ws</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/map.html">map</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">8</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">5</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p>We could use <code><a href="../reference/map.html">map_dbl()</a></code> to compute unweighted means:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/map.html">map_dbl</a></span><span class="op">(</span><span class="va">xs</span>, <span class="va">mean</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1]        NA 0.3248907 0.5328987 0.4806467 0.6243711 0.4456635</span></span>
<span><span class="co">#&gt; [7] 0.4727510 0.3982350</span></span></code></pre></div>
<p>But there’s no way to use <code><a href="../reference/map.html">map()</a></code> to compute a weighted
mean because we need to call
<code>weighted.mean(xs[[1]], ws[[1]])</code>,
<code>weighted.mean(xs[[2]], ws[[2]])</code>, etc. That’s the job of
<code><a href="../reference/map2.html">map2()</a></code>:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/map2.html">map2_dbl</a></span><span class="op">(</span><span class="va">xs</span>, <span class="va">ws</span>, <span class="va">weighted.mean</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1]        NA 0.3211461 0.5381426 0.4978449 0.5985014 0.4220626</span></span>
<span><span class="co">#&gt; [7] 0.4733208 0.4016337</span></span></code></pre></div>
<p>Note that the arguments that vary for each call come before the
function and arguments that are constant come after the function:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/map2.html">map2_dbl</a></span><span class="op">(</span><span class="va">xs</span>, <span class="va">ws</span>, <span class="va">weighted.mean</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.5338666 0.3211461 0.5381426 0.4978449 0.5985014 0.4220626</span></span>
<span><span class="co">#&gt; [7] 0.4733208 0.4016337</span></span></code></pre></div>
<p>But we generally recommend using an anonymous function instead, as
this makes it very clear where each argument is going:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/map2.html">map2_dbl</a></span><span class="op">(</span><span class="va">xs</span>, <span class="va">ws</span>, \<span class="op">(</span><span class="va">x</span>, <span class="va">w</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/weighted.mean.html" class="external-link">weighted.mean</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">w</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>There are two important variants of <code><a href="../reference/map2.html">map2()</a></code>:
<code><a href="../reference/pmap.html">pmap()</a></code> which can take any number of varying arguments
(passed as a list), and <code><a href="../reference/imap.html">imap()</a></code> which iterates over the
values and indices of a single vector. Learn more in their
documentation.</p>
</div>
<div class="section level3">
<h3 id="combinatorial-explosion">Combinatorial explosion<a class="anchor" aria-label="anchor" href="#combinatorial-explosion"></a>
</h3>
<p>What makes purrr particularly special is that all of the above
features (progress bars, parallel computing, output variants, and input
variants) can be combined any way that you choose. The combination of
inputs (prefixes) and outputs (suffixes) forms a matrix, and you can use
<code>.progress</code> or <code><a href="../reference/in_parallel.html">in_parallel()</a></code> with any of
them:</p>
<table class="table">
<colgroup>
<col width="23%">
<col width="23%">
<col width="26%">
<col width="27%">
</colgroup>
<thead><tr class="header">
<th>Output type</th>
<th>Single input (<code>.x</code>)</th>
<th>Two inputs (<code>.x</code>, <code>.y</code>)</th>
<th>Multiple inputs (<code>.l</code>)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><strong>List</strong></td>
<td><code>map(.x, .f)</code></td>
<td><code>map2(.x, .y, .f)</code></td>
<td><code>pmap(.l, .f)</code></td>
</tr>
<tr class="even">
<td><strong>Logical</strong></td>
<td><code>map_lgl(.x, .f)</code></td>
<td><code>map2_lgl(.x, .y, .f)</code></td>
<td><code>pmap_lgl(.l, .f)</code></td>
</tr>
<tr class="odd">
<td><strong>Integer</strong></td>
<td><code>map_int(.x, .f)</code></td>
<td><code>map2_int(.x, .y, .f)</code></td>
<td><code>pmap_int(.l, .f)</code></td>
</tr>
<tr class="even">
<td><strong>Double</strong></td>
<td><code>map_dbl(.x, .f)</code></td>
<td><code>map2_dbl(.x, .y, .f)</code></td>
<td><code>pmap_dbl(.l, .f)</code></td>
</tr>
<tr class="odd">
<td><strong>Character</strong></td>
<td><code>map_chr(.x, .f)</code></td>
<td><code>map2_chr(.x, .y, .f)</code></td>
<td><code>pmap_chr(.l, .f)</code></td>
</tr>
<tr class="even">
<td><strong>Vector</strong></td>
<td><code>map_vec(.x, .f)</code></td>
<td><code>map_vec(.x, .y, .f)</code></td>
<td><code>map_vec(.l, .f)</code></td>
</tr>
<tr class="odd">
<td><strong>Input</strong></td>
<td><code>walk(.x, .f)</code></td>
<td><code>walk2(.x, .y, .f)</code></td>
<td><code>pwalk(.l, .f)</code></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level2">
<h2 id="filtering-and-finding-with-predicates">Filtering and finding with predicates<a class="anchor" aria-label="anchor" href="#filtering-and-finding-with-predicates"></a>
</h2>
<!-- FIXME: Consider providing a more concrete motivating example at the start - perhaps finding the first numeric column in a data frame -->
<p>purrr provides a number of functions that work with predicate
functions. Predicate functions take a vector and return either
<code>TRUE</code> or <code>FALSE</code>, with examples including
<code><a href="https://rdrr.io/r/base/character.html" class="external-link">is.character()</a></code> and <code>\(x) any(is.na(x))</code>. You
typically use them to filter or find; for example, you could use them to
locate the first element of a list that’s a character vector, or only
keep the columns in a data frame that have missing values.</p>
<p>purrr comes with a bunch of helpers to make predicate functions
easier to use:</p>
<ul>
<li>
<code>detect(.x, .p)</code> returns the value of the first element
in <code>.x</code> where <code>.p</code> is <code>TRUE</code>.</li>
<li>
<code>detect_index(.x, .p)</code> returns the position of the first
element in <code>.x</code> where <code>.p</code> is
<code>TRUE</code>.</li>
<li>
<code>keep(.x, .p)</code> returns all elements from <code>.x</code>
where <code>.p</code> evaluates to <code>TRUE</code>.</li>
<li>
<code>discard(.x, .p)</code> returns all elements from
<code>.x</code> where <code>.p</code> evaluates to
<code>FALSE</code>.</li>
<li>
<code>every(.x, .p)</code> returns <code>TRUE</code> if
<code>.p</code> returns <code>TRUE</code> for every element in
<code>.x</code>.</li>
<li>
<code>some(.x, .p)</code> returns <code>TRUE</code> if
<code>.p</code> returns <code>TRUE</code> for at least one element in
<code>.x</code>.</li>
<li>
<code>none(.x, .p)</code> returns <code>TRUE</code> if
<code>.p</code> returns <code>FALSE</code> for all elements in
<code>.x</code>.</li>
<li>
<code>head_while(.x, .p)</code> returns elements from the beginning
of <code>.x</code> while <code>.p</code> is <code>TRUE</code>, stopping
at the first <code>FALSE</code>.</li>
<li>
<code>tail_while(.x, .p)</code> returns elements from the end of
<code>.x</code> while <code>.p</code> is <code>TRUE</code>, stopping at
the first <code>FALSE</code>.</li>
</ul>
<p>You’ll typically use these functions with lists, since you can
usually rely on vectorization for simpler vectors.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  a <span class="op">=</span> <span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>,</span>
<span>  b <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,</span>
<span>  c <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">15</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">x</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/detect.html">detect</a></span><span class="op">(</span><span class="va">is.character</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "a" "b" "c" "d" "e" "f" "g" "h" "i" "j"</span></span>
<span><span class="va">x</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/detect.html">detect_index</a></span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 2</span></span>
<span></span>
<span><span class="va">x</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/keep.html">keep</a></span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 2</span></span>
<span><span class="co">#&gt;  $ b: int [1:10] 1 2 3 4 5 6 7 8 9 10</span></span>
<span><span class="co">#&gt;  $ c: num [1:15] 0.819 0.903 0.581 0.773 0.995 ...</span></span>
<span><span class="va">x</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/keep.html">discard</a></span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 1</span></span>
<span><span class="co">#&gt;  $ a: chr [1:10] "a" "b" "c" "d" ...</span></span>
<span></span>
<span><span class="va">x</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/every.html">every</a></span><span class="op">(</span>\<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span>
<span><span class="va">x</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/every.html">some</a></span><span class="op">(</span>\<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="va">x</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/every.html">none</a></span><span class="op">(</span>\<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



   </div>
  <footer><div class="container">
  <div class="pkgdown-footer-left">
  <p>Developed by <a href="https://hadley.nz" class="external-link">Hadley Wickham</a>, <a href="https://github.com/lionel-" class="external-link">Lionel Henry</a>, <a href="https://www.posit.co" class="external-link"><img src="https://www.tidyverse.org/posit-logo.svg" alt="Posit" height="16" width="62" style="margin-bottom: 3px;"></a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

  </div></footer>
</body>
</html>
