<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>purrr &lt;-&gt; base R • purrr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_Pro-0.4.10/font.css" rel="stylesheet">
<link href="../deps/Source_Code_Pro-0.4.10/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="purrr &lt;-&gt; base R">
<meta name="robots" content="noindex">
<script defer data-domain="purrr.tidyverse.org,all.tidyverse.org" src="https://plausible.io/js/plausible.js"></script>
</head>
<body>
    <a href="#container" class="visually-hidden-focusable">Skip to content</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-none" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">purrr</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">1.1.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/base.html">purrr &lt;-&gt; base R</a></li>
    <li><a class="dropdown-item" href="../articles/other-langs.html">Functional programming in other languages</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-news" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">News</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-news">
<li><h6 class="dropdown-header" data-toc-skip>Releases</h6></li>
    <li><a class="external-link dropdown-item" href="https://www.tidyverse.org/blog/2025/07/purrr-1-1-0-parallel/">Version 1.1.0</a></li>
    <li><a class="external-link dropdown-item" href="https://www.tidyverse.org/blog/2022/12/purrr-1-0-0/">Version 1.0.0</a></li>
    <li><a class="external-link dropdown-item" href="https://www.tidyverse.org/articles/2019/02/purrr-0-3-0/">Version 0.3.0</a></li>
    <li><a class="external-link dropdown-item" href="https://www.tidyverse.org/articles/2017/08/purrr-0.2.3/">Version 0.2.3</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../news/index.html">Changelog</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/tidyverse/purrr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article" id="container">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>purrr &lt;-&gt; base R</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/tidyverse/purrr/blob/main/vignettes/base.Rmd" class="external-link"><code>vignettes/base.Rmd</code></a></small>
      <div class="d-none name"><code>base.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette compares purrr’s functionals to their base R
equivalents, focusing primarily on the map family and related functions.
This helps those familiar with base R understand better what purrr does,
and shows purrr users how you might express the same ideas in base R
code. We’ll start with a rough overview of the major differences, give a
rough translation guide, and then show a few examples.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://purrr.tidyverse.org/">purrr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/" class="external-link">tibble</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="key-differences">Key differences<a class="anchor" aria-label="anchor" href="#key-differences"></a>
</h3>
<p>There are two primary differences between the base apply family and
the purrr map family: purrr functions are named more consistently, and
more fully explore the space of input and output variants.</p>
<ul>
<li><p>purrr functions consistently use <code>.</code> as prefix to
avoid <a href="https://adv-r.hadley.nz/functionals.html#argument-names" class="external-link">inadvertently
matching arguments</a> of the purrr function, instead of the function
that you’re trying to call. Base functions use a variety of techniques
including upper case (e.g. <code>lapply(X, FUN, ...)</code>) or require
anonymous functions (e.g. <code><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Map()</a></code>).</p></li>
<li><p>All map functions are type stable: you can predict the type of
the output using little information about the inputs. In contrast, the
base functions <code><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply()</a></code> and <code><a href="https://rdrr.io/r/base/mapply.html" class="external-link">mapply()</a></code>
automatically simplify making the return value hard to predict.</p></li>
<li><p>The map functions all start with the data, followed by the
function, then any additional constant argument. Most base apply
functions also follow this pattern, but <code><a href="https://rdrr.io/r/base/mapply.html" class="external-link">mapply()</a></code> starts
with the function, and <code><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Map()</a></code> has no way to supply
additional constant arguments.</p></li>
<li><p>purrr functions provide all combinations of input and output
variants, and include variants specifically for the common two argument
case.</p></li>
</ul>
</div>
<div class="section level3">
<h3 id="direct-translations">Direct translations<a class="anchor" aria-label="anchor" href="#direct-translations"></a>
</h3>
<p>The following sections give a high-level translation between base R
commands and their purrr equivalents. See function documentation for the
details.</p>
<div class="section level4">
<h4 id="map-functions">
<code>Map</code> functions<a class="anchor" aria-label="anchor" href="#map-functions"></a>
</h4>
<p>Here <code>x</code> denotes a vector and <code>f</code> denotes a
function</p>
<table class="table">
<colgroup>
<col width="24%">
<col width="24%">
<col width="24%">
<col width="26%">
</colgroup>
<thead><tr class="header">
<th>Output</th>
<th>Input</th>
<th>Base R</th>
<th>purrr</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>List</td>
<td>1 vector</td>
<td><code><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply()</a></code></td>
<td><code><a href="../reference/map.html">map()</a></code></td>
</tr>
<tr class="even">
<td>List</td>
<td>2 vectors</td>
<td>
<code><a href="https://rdrr.io/r/base/mapply.html" class="external-link">mapply()</a></code>, <code><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Map()</a></code>
</td>
<td><code><a href="../reference/map2.html">map2()</a></code></td>
</tr>
<tr class="odd">
<td>List</td>
<td>&gt;2 vectors</td>
<td>
<code><a href="https://rdrr.io/r/base/mapply.html" class="external-link">mapply()</a></code>, <code><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Map()</a></code>
</td>
<td><code><a href="../reference/pmap.html">pmap()</a></code></td>
</tr>
<tr class="even">
<td>Atomic vector of desired type</td>
<td>1 vector</td>
<td><code><a href="https://rdrr.io/r/base/lapply.html" class="external-link">vapply()</a></code></td>
<td>
<code><a href="../reference/map.html">map_lgl()</a></code> (logical), <code><a href="../reference/map.html">map_int()</a></code> (integer),
<code><a href="../reference/map.html">map_dbl()</a></code> (double), <code><a href="../reference/map.html">map_chr()</a></code> (character),
<code><a href="../reference/map.html">map_vec()</a></code> (other vectors)</td>
</tr>
<tr class="odd">
<td>Atomic vector of desired type</td>
<td>2 vectors</td>
<td>
<code><a href="https://rdrr.io/r/base/mapply.html" class="external-link">mapply()</a></code>, <code><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Map()</a></code>, then <code>is.*()</code>
to check type</td>
<td>
<code><a href="../reference/map2.html">map2_lgl()</a></code> (logical), <code><a href="../reference/map2.html">map2_int()</a></code>
(integer), <code><a href="../reference/map2.html">map2_dbl()</a></code> (double), <code><a href="../reference/map2.html">map2_chr()</a></code>
(character), <code><a href="../reference/map2.html">map2_vec()</a></code> (other vectors)</td>
</tr>
<tr class="even">
<td>Atomic vector of desired type</td>
<td>&gt;2 vectors</td>
<td>
<code><a href="https://rdrr.io/r/base/mapply.html" class="external-link">mapply()</a></code>, <code><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Map()</a></code>, then <code>is.*()</code>
to check type</td>
<td>
<code><a href="../reference/pmap.html">pmap_lgl()</a></code> (logical), <code><a href="../reference/pmap.html">pmap_int()</a></code>
(integer), <code><a href="../reference/pmap.html">pmap_dbl()</a></code> (double), <code><a href="../reference/pmap.html">pmap_chr()</a></code>
(character), <code><a href="../reference/pmap.html">pmap_vec()</a></code> (other vectors)</td>
</tr>
<tr class="odd">
<td>Side effect only</td>
<td>2 vectors</td>
<td>loops</td>
<td><code><a href="../reference/map2.html">walk2()</a></code></td>
</tr>
<tr class="even">
<td>Side effect only</td>
<td>1 vector</td>
<td>loops</td>
<td><code><a href="../reference/map.html">walk()</a></code></td>
</tr>
<tr class="odd">
<td>Side effect only</td>
<td>&gt;2 vectors</td>
<td>loops</td>
<td><code><a href="../reference/pmap.html">pwalk()</a></code></td>
</tr>
<tr class="even">
<td>Data frame (<code>rbind</code> outputs)</td>
<td>1 vector</td>
<td>
<code><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply()</a></code> then <code><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind()</a></code>
</td>
<td>
<code><a href="../reference/map.html">map()</a></code> then <code><a href="../reference/list_c.html">list_rbind()</a></code>
</td>
</tr>
<tr class="odd">
<td>Data frame (<code>rbind</code> outputs)</td>
<td>2 vectors</td>
<td>
<code><a href="https://rdrr.io/r/base/mapply.html" class="external-link">mapply()</a></code>/<code><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Map()</a></code> then
<code><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind()</a></code>
</td>
<td>
<code><a href="../reference/map2.html">map2()</a></code> then <code><a href="../reference/list_c.html">list_rbind()</a></code>
</td>
</tr>
<tr class="even">
<td>Data frame (<code>rbind</code> outputs)</td>
<td>&gt;2 vectors</td>
<td>
<code><a href="https://rdrr.io/r/base/mapply.html" class="external-link">mapply()</a></code>/<code><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Map()</a></code> then
<code><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind()</a></code>
</td>
<td>
<code><a href="../reference/pmap.html">pmap()</a></code> then <code><a href="../reference/list_c.html">list_rbind()</a></code>
</td>
</tr>
<tr class="odd">
<td>Data frame (<code>cbind</code> outputs)</td>
<td>1 vector</td>
<td>
<code><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply()</a></code> then <code><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind()</a></code>
</td>
<td>
<code><a href="../reference/map.html">map()</a></code> then <code><a href="../reference/list_c.html">list_cbind()</a></code>
</td>
</tr>
<tr class="even">
<td>Data frame (<code>cbind</code> outputs)</td>
<td>2 vectors</td>
<td>
<code><a href="https://rdrr.io/r/base/mapply.html" class="external-link">mapply()</a></code>/<code><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Map()</a></code> then
<code><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind()</a></code>
</td>
<td>
<code><a href="../reference/map2.html">map2()</a></code> then <code><a href="../reference/list_c.html">list_cbind()</a></code>
</td>
</tr>
<tr class="odd">
<td>Data frame (<code>cbind</code> outputs)</td>
<td>&gt;2 vectors</td>
<td>
<code><a href="https://rdrr.io/r/base/mapply.html" class="external-link">mapply()</a></code>/<code><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Map()</a></code> then
<code><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind()</a></code>
</td>
<td>
<code><a href="../reference/pmap.html">pmap()</a></code> then <code><a href="../reference/list_c.html">list_cbind()</a></code>
</td>
</tr>
<tr class="even">
<td>Any</td>
<td>Vector and its names</td>
<td>
<code>l/s/vapply(X, function(x) f(x, names(x)))</code> or
<code>mapply/Map(f, x, names(x))</code>
</td>
<td>
<code><a href="../reference/imap.html">imap()</a></code>, <code>imap_*()</code> (<code>lgl</code>,
<code>dbl</code>, <code>chr</code>, and etc. just like for
<code><a href="../reference/map.html">map()</a></code>, <code><a href="../reference/map2.html">map2()</a></code>, and <code><a href="../reference/pmap.html">pmap()</a></code>)</td>
</tr>
<tr class="odd">
<td>Any</td>
<td>Selected elements of the vector</td>
<td><code>l/s/vapply(X[index], FUN, ...)</code></td>
<td>
<code><a href="../reference/map_if.html">map_if()</a></code>, <code><a href="../reference/map_if.html">map_at()</a></code>
</td>
</tr>
<tr class="even">
<td>List</td>
<td>Recursively apply to list within list</td>
<td><code><a href="https://rdrr.io/r/base/rapply.html" class="external-link">rapply()</a></code></td>
<td><code><a href="../reference/map_depth.html">map_depth()</a></code></td>
</tr>
<tr class="odd">
<td>List</td>
<td>List only</td>
<td><code><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply()</a></code></td>
<td>
<code><a href="../reference/lmap.html">lmap()</a></code>, <code><a href="../reference/lmap.html">lmap_at()</a></code>,
<code><a href="../reference/lmap.html">lmap_if()</a></code>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section level4">
<h4 id="extractor-shorthands">Extractor shorthands<a class="anchor" aria-label="anchor" href="#extractor-shorthands"></a>
</h4>
<p>Since a common use case for map functions is list extracting
components, purrr provides a handful of shortcut functions for various
uses of <code>[[</code>.</p>
<table class="table">
<colgroup>
<col width="26%">
<col width="36%">
<col width="37%">
</colgroup>
<thead><tr class="header">
<th>Input</th>
<th>base R</th>
<th>purrr</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Extract by name</td>
<td><code>lapply(x, `[[`, "a")</code></td>
<td><code>map(x, "a")</code></td>
</tr>
<tr class="even">
<td>Extract by position</td>
<td><code>lapply(x, `[[`, 3)</code></td>
<td><code>map(x, 3)</code></td>
</tr>
<tr class="odd">
<td>Extract deeply</td>
<td><code>lapply(x, \(y) y[[1]][["x"]][[3]])</code></td>
<td><code>map(x, list(1, "x", 3))</code></td>
</tr>
<tr class="even">
<td>Extract with default value</td>
<td><code>lapply(x, function(y) tryCatch(y[[3]], error = function(e) NA))</code></td>
<td><code>map(x, 3, .default = NA)</code></td>
</tr>
</tbody>
</table>
</div>
<div class="section level4">
<h4 id="predicates">Predicates<a class="anchor" aria-label="anchor" href="#predicates"></a>
</h4>
<p>Here <code>p</code>, a predicate, denotes a function that returns
<code>TRUE</code> or <code>FALSE</code> indicating whether an object
fulfills a criterion, e.g. <code><a href="https://rdrr.io/r/base/character.html" class="external-link">is.character()</a></code>.</p>
<table class="table">
<colgroup>
<col width="40%">
<col width="27%">
<col width="31%">
</colgroup>
<thead><tr class="header">
<th>Description</th>
<th>base R</th>
<th>purrr</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Find a matching element</td>
<td><code>Find(p, x)</code></td>
<td>
<code>detect(x, p)</code>,</td>
</tr>
<tr class="even">
<td>Find position of matching element</td>
<td><code>Position(p, x)</code></td>
<td><code>detect_index(x, p)</code></td>
</tr>
<tr class="odd">
<td>Do all elements of a vector satisfy a predicate?</td>
<td><code>all(sapply(x, p))</code></td>
<td><code>every(x, p)</code></td>
</tr>
<tr class="even">
<td>Does any elements of a vector satisfy a predicate?</td>
<td><code>any(sapply(x, p))</code></td>
<td><code>some(x, p)</code></td>
</tr>
<tr class="odd">
<td>Does a list contain an object?</td>
<td><code>any(sapply(x, identical, obj))</code></td>
<td><code>has_element(x, obj)</code></td>
</tr>
<tr class="even">
<td>Keep elements that satisfy a predicate</td>
<td><code>x[sapply(x, p)]</code></td>
<td><code>keep(x, p)</code></td>
</tr>
<tr class="odd">
<td>Discard elements that satisfy a predicate</td>
<td><code>x[!sapply(x, p)]</code></td>
<td><code>discard(x, p)</code></td>
</tr>
<tr class="even">
<td>Negate a predicate function</td>
<td><code>function(x) !p(x)</code></td>
<td><code>negate(p)</code></td>
</tr>
</tbody>
</table>
</div>
<div class="section level4">
<h4 id="other-vector-transforms">Other vector transforms<a class="anchor" aria-label="anchor" href="#other-vector-transforms"></a>
</h4>
<table class="table">
<colgroup>
<col width="40%">
<col width="27%">
<col width="31%">
</colgroup>
<thead><tr class="header">
<th>Description</th>
<th>base R</th>
<th>purrr</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Accumulate intermediate results of a vector reduction</td>
<td><code>Reduce(f, x, accumulate = TRUE)</code></td>
<td><code>accumulate(x, f)</code></td>
</tr>
<tr class="even">
<td>Recursively combine two lists</td>
<td>
<code>c(X, Y)</code>, but more complicated to merge recursively</td>
<td>
<code><a href="../reference/list_assign.html">list_merge()</a></code>, <code><a href="../reference/list_assign.html">list_modify()</a></code>
</td>
</tr>
<tr class="odd">
<td>Reduce a list to a single value by iteratively applying a binary
function</td>
<td><code>Reduce(f, x)</code></td>
<td><code>reduce(x, f)</code></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level3">
<h3 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h3>
<div class="section level4">
<h4 id="varying-inputs">Varying inputs<a class="anchor" aria-label="anchor" href="#varying-inputs"></a>
</h4>
<div class="section level5">
<h5 id="one-input">One input<a class="anchor" aria-label="anchor" href="#one-input"></a>
</h5>
<p>Suppose we would like to generate a list of samples of 5 from normal
distributions with different means:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">means</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span></span></code></pre></div>
<p>There’s little difference when generating the samples:</p>
<ul>
<li>
<p>Base R uses <code><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply()</a></code>:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2020</span><span class="op">)</span></span>
<span><span class="va">samples</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">means</span>, <span class="va">rnorm</span>, n <span class="op">=</span> <span class="fl">5</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">samples</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 4</span></span>
<span><span class="co">#&gt;  $ : num [1:5] 1.377 1.302 -0.098 -0.13 -1.797</span></span>
<span><span class="co">#&gt;  $ : num [1:5] 2.72 2.94 1.77 3.76 2.12</span></span>
<span><span class="co">#&gt;  $ : num [1:5] 2.15 3.91 4.2 2.63 2.88</span></span>
<span><span class="co">#&gt;  $ : num [1:5] 5.8 5.704 0.961 1.711 4.058</span></span></code></pre></div>
</li>
<li>
<p>purrr uses <code><a href="../reference/map.html">map()</a></code>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2020</span><span class="op">)</span></span>
<span><span class="va">samples</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/map.html">map</a></span><span class="op">(</span><span class="va">means</span>, <span class="va">rnorm</span>, n <span class="op">=</span> <span class="fl">5</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">samples</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 4</span></span>
<span><span class="co">#&gt;  $ : num [1:5] 1.377 1.302 -0.098 -0.13 -1.797</span></span>
<span><span class="co">#&gt;  $ : num [1:5] 2.72 2.94 1.77 3.76 2.12</span></span>
<span><span class="co">#&gt;  $ : num [1:5] 2.15 3.91 4.2 2.63 2.88</span></span>
<span><span class="co">#&gt;  $ : num [1:5] 5.8 5.704 0.961 1.711 4.058</span></span></code></pre></div>
</li>
</ul>
</div>
<div class="section level5">
<h5 id="two-inputs">Two inputs<a class="anchor" aria-label="anchor" href="#two-inputs"></a>
</h5>
<p>Lets make the example a little more complicated by also varying the
standard deviations:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">means</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span></span>
<span><span class="va">sds</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span></span></code></pre></div>
<ul>
<li>
<p>This is relatively tricky in base R because we have to adjust a
number of <code><a href="https://rdrr.io/r/base/mapply.html" class="external-link">mapply()</a></code>’s defaults.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2020</span><span class="op">)</span></span>
<span><span class="va">samples</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mapply.html" class="external-link">mapply</a></span><span class="op">(</span></span>
<span>  <span class="va">rnorm</span>, </span>
<span>  mean <span class="op">=</span> <span class="va">means</span>, </span>
<span>  sd <span class="op">=</span> <span class="va">sds</span>, </span>
<span>  MoreArgs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>, </span>
<span>  SIMPLIFY <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">samples</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 4</span></span>
<span><span class="co">#&gt;  $ : num [1:5] 1.377 1.302 -0.098 -0.13 -1.797</span></span>
<span><span class="co">#&gt;  $ : num [1:5] 3.44 3.88 1.54 5.52 2.23</span></span>
<span><span class="co">#&gt;  $ : num [1:5] 0.441 5.728 6.589 1.885 2.63</span></span>
<span><span class="co">#&gt;  $ : num [1:5] 11.2 10.82 -8.16 -5.16 4.23</span></span></code></pre></div>
<p>Alternatively, we could use <code><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Map()</a></code> which doesn’t
simplify, but also doesn’t take any constant arguments, so we need to
use an anonymous function:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">samples</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Map</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">...</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">...</span>, n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>, mean <span class="op">=</span> <span class="va">means</span>, sd <span class="op">=</span> <span class="va">sds</span><span class="op">)</span></span></code></pre></div>
<p>In R 4.1 and up, you could use the shorter anonymous function
form:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">samples</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Map</a></span><span class="op">(</span>\<span class="op">(</span><span class="va">...</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">...</span>, n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>, mean <span class="op">=</span> <span class="va">means</span>, sd <span class="op">=</span> <span class="va">sds</span><span class="op">)</span></span></code></pre></div>
</li>
<li>
<p>Working with a pair of vectors is a common situation so purrr
provides the <code><a href="../reference/map2.html">map2()</a></code> family of functions:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2020</span><span class="op">)</span></span>
<span><span class="va">samples</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/map2.html">map2</a></span><span class="op">(</span><span class="va">means</span>, <span class="va">sds</span>, <span class="va">rnorm</span>, n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">samples</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 4</span></span>
<span><span class="co">#&gt;  $ : num [1:5] 1.377 1.302 -0.098 -0.13 -1.797</span></span>
<span><span class="co">#&gt;  $ : num [1:5] 3.44 3.88 1.54 5.52 2.23</span></span>
<span><span class="co">#&gt;  $ : num [1:5] 0.441 5.728 6.589 1.885 2.63</span></span>
<span><span class="co">#&gt;  $ : num [1:5] 11.2 10.82 -8.16 -5.16 4.23</span></span></code></pre></div>
</li>
</ul>
</div>
<div class="section level5">
<h5 id="any-number-of-inputs">Any number of inputs<a class="anchor" aria-label="anchor" href="#any-number-of-inputs"></a>
</h5>
<p>We can make the challenge still more complex by also varying the
number of samples:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ns</span> <span class="op">&lt;-</span> <span class="fl">4</span><span class="op">:</span><span class="fl">1</span></span></code></pre></div>
<ul>
<li>
<p>Using base R’s <code><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Map()</a></code> becomes more straightforward
because there are no constant arguments.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2020</span><span class="op">)</span></span>
<span><span class="va">samples</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Map</a></span><span class="op">(</span><span class="va">rnorm</span>, mean <span class="op">=</span> <span class="va">means</span>, sd <span class="op">=</span> <span class="va">sds</span>, n <span class="op">=</span> <span class="va">ns</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">samples</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 4</span></span>
<span><span class="co">#&gt;  $ : num [1:4] 1.377 1.302 -0.098 -0.13</span></span>
<span><span class="co">#&gt;  $ : num [1:3] -3.59 3.44 3.88</span></span>
<span><span class="co">#&gt;  $ : num [1:2] 2.31 8.28</span></span>
<span><span class="co">#&gt;  $ : num 4.47</span></span></code></pre></div>
</li>
<li>
<p>In purrr, we need to switch from <code><a href="../reference/map2.html">map2()</a></code> to
<code><a href="../reference/pmap.html">pmap()</a></code> which takes a list of any number of arguments.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2020</span><span class="op">)</span></span>
<span><span class="va">samples</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pmap.html">pmap</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="va">means</span>, sd <span class="op">=</span> <span class="va">sds</span>, n <span class="op">=</span> <span class="va">ns</span><span class="op">)</span>, <span class="va">rnorm</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">samples</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 4</span></span>
<span><span class="co">#&gt;  $ : num [1:4] 1.377 1.302 -0.098 -0.13</span></span>
<span><span class="co">#&gt;  $ : num [1:3] -3.59 3.44 3.88</span></span>
<span><span class="co">#&gt;  $ : num [1:2] 2.31 8.28</span></span>
<span><span class="co">#&gt;  $ : num 4.47</span></span></code></pre></div>
</li>
</ul>
</div>
</div>
<div class="section level4">
<h4 id="outputs">Outputs<a class="anchor" aria-label="anchor" href="#outputs"></a>
</h4>
<p>Given the samples, imagine we want to compute their means. A mean is
a single number, so we want the output to be a numeric vector rather
than a list.</p>
<ul>
<li>
<p>There are two options in base R: <code><a href="https://rdrr.io/r/base/lapply.html" class="external-link">vapply()</a></code> or
<code><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply()</a></code>. <code><a href="https://rdrr.io/r/base/lapply.html" class="external-link">vapply()</a></code> requires you to specific
the output type (so is relatively verbose), but will always return a
numeric vector. <code><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply()</a></code> is concise, but if you supply an
empty list you’ll get a list instead of a numeric vector.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># type stable</span></span>
<span><span class="va">medians</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">vapply</a></span><span class="op">(</span><span class="va">samples</span>, <span class="va">median</span>, FUN.VALUE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="fl">1L</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">medians</span></span>
<span><span class="co">#&gt; [1] 0.6017626 3.4411470 5.2946304 4.4694671</span></span>
<span></span>
<span><span class="co"># not type stable</span></span>
<span><span class="va">medians</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">samples</span>, <span class="va">median</span><span class="op">)</span></span></code></pre></div>
</li>
<li>
<p>purrr is little more compact because we can use
<code><a href="../reference/map.html">map_dbl()</a></code>.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">medians</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/map.html">map_dbl</a></span><span class="op">(</span><span class="va">samples</span>, <span class="va">median</span><span class="op">)</span></span>
<span><span class="va">medians</span></span>
<span><span class="co">#&gt; [1] 0.6017626 3.4411470 5.2946304 4.4694671</span></span></code></pre></div>
</li>
</ul>
<p>What if we want just the side effect, such as a plot or a file
output, but not the returned values?</p>
<ul>
<li>
<p>In base R we can either use a for loop or hide the results of
<code>lapply</code>.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># for loop</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">s</span> <span class="kw">in</span> <span class="va">samples</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">s</span>, xlab <span class="op">=</span> <span class="st">"value"</span>, main <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># lapply</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/invisible.html" class="external-link">invisible</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">samples</span>, <span class="kw">function</span><span class="op">(</span><span class="va">s</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">s</span>, xlab <span class="op">=</span> <span class="st">"value"</span>, main <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</li>
<li>
<p>In purrr, we can use <code><a href="../reference/map.html">walk()</a></code>.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/map.html">walk</a></span><span class="op">(</span><span class="va">samples</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">.x</span>, xlab <span class="op">=</span> <span class="st">"value"</span>, main <span class="op">=</span> <span class="st">""</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</li>
</ul>
</div>
<div class="section level4">
<h4 id="pipes">Pipes<a class="anchor" aria-label="anchor" href="#pipes"></a>
</h4>
<p>You can join multiple steps together with the pipe:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2020</span><span class="op">)</span></span>
<span><span class="va">means</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/map.html">map</a></span><span class="op">(</span><span class="va">rnorm</span>, n <span class="op">=</span> <span class="fl">5</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/map.html">map_dbl</a></span><span class="op">(</span><span class="va">median</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] -0.09802317  2.72057350  2.87673977  4.05830349</span></span></code></pre></div>
<p>The pipe is particularly compelling when working with longer
transformations. For example, the following code splits
<code>mtcars</code> up by <code>cyl</code>, fits a linear model,
extracts the coefficients, and extracts the first one (the
intercept).</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mtcars</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">$</span><span class="va">cyl</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/map.html">map</a></span><span class="op">(</span>\<span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">mpg</span> <span class="op">~</span> <span class="va">wt</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span><span class="op">)</span><span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/map.html">map</a></span><span class="op">(</span><span class="va">coef</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/map.html">map_dbl</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt;        4        6        8 </span></span>
<span><span class="co">#&gt; 39.57120 28.40884 23.86803</span></span></code></pre></div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



   </div>
  <footer><div class="container">
  <div class="pkgdown-footer-left">
  <p>Developed by <a href="https://hadley.nz" class="external-link">Hadley Wickham</a>, <a href="https://github.com/lionel-" class="external-link">Lionel Henry</a>, <a href="https://www.posit.co" class="external-link"><img src="https://www.tidyverse.org/posit-logo.svg" alt="Posit" height="16" width="62" style="margin-bottom: 3px;"></a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

  </div></footer>
</body>
</html>
